{
  "project": {
    "name": "Flower Shop System",
    "description": "E-commerce system for flower shop management with customer orders, inventory, and staff management",
    "version": "1.0.0",
    "database": "PostgreSQL",
    "framework": "Spring Boot 3.5.5"
  },
  "enums": {
    "UserRole": {
      "values": ["customer", "staff", "admin"],
      "description": "User roles in the system",
      "usage": "Determines access levels and permissions"
    },
    "OrderStatus": {
      "values": ["pending", "processing", "shipped", "completed", "cancelled"],
      "description": "Order processing statuses",
      "flow": "pending → processing → shipped → completed"
    },
    "PaymentMethod": {
      "values": ["cash_on_delivery", "credit_card", "bank_transfer", "wallet"],
      "description": "Available payment methods for orders"
    },
    "DiscountType": {
      "values": ["percentage", "fixed"],
      "description": "Voucher discount calculation types"
    },
    "TransactionType": {
      "values": ["payment", "refund"],
      "description": "Financial transaction types"
    },
    "TransactionStatus": {
      "values": ["success", "failed"],
      "description": "Transaction processing status"
    }
  },
  "entities": {
    "User": {
      "description": "System users including customers, staff, and administrators",
      "table": "users",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated user ID"
        },
        "firstName": {
          "type": "VARCHAR(100)",
          "required": true,
          "description": "User's first name"
        },
        "lastName": {
          "type": "VARCHAR(100)",
          "required": true,
          "description": "User's last name"
        },
        "email": {
          "type": "VARCHAR(255)",
          "required": true,
          "unique": true,
          "description": "Email address for login and communication"
        },
        "password": {
          "type": "VARCHAR(255)",
          "required": true,
          "constraints": "min 8 characters",
          "description": "Encrypted password for authentication"
        },
        "phone": {
          "type": "VARCHAR(20)",
          "required": true,
          "unique": true,
          "description": "Contact phone number"
        },
        "avatar": {
          "type": "VARCHAR(255)",
          "description": "URL to user's profile picture"
        },
        "cover": {
          "type": "VARCHAR(255)",
          "description": "URL to user's cover/banner image"
        },
        "role": {
          "type": "user_role",
          "default": "customer",
          "description": "User's role in the system"
        },
        "createdAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Account creation timestamp"
        }
      },
      "relationships": {
        "addresses": {
          "type": "one_to_many",
          "entity": "Address",
          "description": "User's delivery addresses"
        },
        "orders": {
          "type": "one_to_many",
          "entity": "Order",
          "description": "Orders placed by the user"
        },
        "cart": {
          "type": "one_to_one",
          "entity": "Cart",
          "description": "User's shopping cart"
        },
        "reviews": {
          "type": "one_to_many",
          "entity": "Review",
          "description": "Product reviews written by user"
        },
        "follows": {
          "type": "one_to_many",
          "entity": "Follow",
          "description": "Products in user's wishlist"
        },
        "transactions": {
          "type": "one_to_many",
          "entity": "Transaction",
          "description": "Payment/refund transactions"
        }
      },
      "business_logic": {
        "authentication": "Email + password login",
        "authorization": "Role-based access control",
        "profile_management": "Users can update profile info and avatar",
        "address_management": "Multiple addresses with default selection"
      }
    },
    "Product": {
      "description": "Flower products available for purchase",
      "table": "products",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated product ID"
        },
        "name": {
          "type": "VARCHAR(255)",
          "required": true,
          "description": "Product name (e.g., 'Red Roses Bouquet')"
        },
        "description": {
          "type": "TEXT",
          "description": "Detailed product description and features"
        },
        "price": {
          "type": "NUMERIC(10,2)",
          "required": true,
          "constraints": "price >= 0",
          "description": "Product price in VND"
        },
        "image": {
          "type": "VARCHAR(255)",
          "description": "URL to product main image"
        },
        "createdAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Product creation timestamp"
        },
        "updatedAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Last update timestamp (auto-updated by trigger)"
        }
      },
      "relationships": {
        "attributeValues": {
          "type": "one_to_many",
          "entity": "AttributeValue",
          "description": "Product attributes like color, size, fragrance"
        },
        "orderItems": {
          "type": "one_to_many",
          "entity": "OrderItem",
          "description": "Order line items containing this product"
        },
        "cartItems": {
          "type": "one_to_many",
          "entity": "CartItem",
          "description": "Shopping cart items"
        },
        "reviews": {
          "type": "one_to_many",
          "entity": "Review",
          "description": "Customer reviews and ratings"
        },
        "follows": {
          "type": "one_to_many",
          "entity": "Follow",
          "description": "Users following this product"
        }
      },
      "business_logic": {
        "pricing": "Fixed pricing, can be updated by admin/staff",
        "attributes": "Dynamic attributes system for variations",
        "reviews": "Customer rating system (1-5 stars)",
        "wishlist": "Users can follow products for later purchase"
      }
    },
    "Order": {
      "description": "Customer orders with items and delivery information",
      "table": "orders",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated order ID"
        },
        "userId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "Customer who placed the order"
        },
        "totalAmount": {
          "type": "NUMERIC(10,2)",
          "constraints": "totalAmount >= 0",
          "description": "Total order amount including delivery fee"
        },
        "status": {
          "type": "order_status",
          "default": "pending",
          "description": "Current order processing status"
        },
        "orderDate": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "When the order was placed"
        },
        "deliveryUnitId": {
          "type": "BIGINT",
          "foreign_key": "deliveryunits.id",
          "description": "Selected delivery service"
        },
        "voucherId": {
          "type": "BIGINT",
          "foreign_key": "vouchers.id",
          "description": "Applied discount voucher"
        },
        "addressId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "addresses.id",
          "description": "Delivery address"
        },
        "paymentMethod": {
          "type": "payment_method",
          "default": "cash_on_delivery",
          "description": "Selected payment method"
        },
        "notes": {
          "type": "TEXT",
          "description": "Special delivery instructions or notes"
        }
      },
      "relationships": {
        "user": {
          "type": "many_to_one",
          "entity": "User",
          "description": "Customer who placed the order"
        },
        "orderItems": {
          "type": "one_to_many",
          "entity": "OrderItem",
          "description": "Products and quantities in this order"
        },
        "address": {
          "type": "many_to_one",
          "entity": "Address",
          "description": "Delivery address"
        },
        "deliveryUnit": {
          "type": "many_to_one",
          "entity": "DeliveryUnit",
          "description": "Delivery service provider"
        },
        "voucher": {
          "type": "many_to_one",
          "entity": "Voucher",
          "description": "Applied discount voucher"
        },
        "transactions": {
          "type": "one_to_many",
          "entity": "Transaction",
          "description": "Payment and refund transactions"
        }
      },
      "business_logic": {
        "workflow": "pending → processing → shipped → completed",
        "cancellation": "Orders can be cancelled before shipping",
        "payment": "Support multiple payment methods",
        "delivery": "Integration with delivery service providers",
        "discounts": "Voucher-based discount system"
      }
    },
    "Cart": {
      "description": "Shopping cart for users to collect items before ordering",
      "table": "carts",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated cart ID"
        },
        "userId": {
          "type": "BIGINT",
          "required": true,
          "unique": true,
          "foreign_key": "users.id",
          "description": "Cart owner (one cart per user)"
        },
        "createdAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Cart creation timestamp"
        },
        "updatedAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Last update timestamp"
        }
      },
      "relationships": {
        "user": {
          "type": "one_to_one",
          "entity": "User",
          "description": "Cart owner"
        },
        "cartItems": {
          "type": "one_to_many",
          "entity": "CartItem",
          "description": "Items in the cart"
        }
      },
      "business_logic": {
        "persistence": "Cart persists across user sessions",
        "uniqueness": "One cart per user",
        "checkout": "Cart items are transferred to order on checkout"
      }
    },
    "Address": {
      "description": "User delivery addresses with default selection support",
      "table": "addresses",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated address ID"
        },
        "userId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "Address owner"
        },
        "street": {
          "type": "VARCHAR(255)",
          "required": true,
          "description": "Street address"
        },
        "city": {
          "type": "VARCHAR(100)",
          "required": true,
          "description": "City name"
        },
        "province": {
          "type": "VARCHAR(100)",
          "required": true,
          "description": "Province/state"
        },
        "isDefault": {
          "type": "BOOLEAN",
          "default": false,
          "description": "Whether this is the user's default address"
        },
        "createdAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Address creation timestamp"
        }
      },
      "relationships": {
        "user": {
          "type": "many_to_one",
          "entity": "User",
          "description": "Address owner"
        },
        "orders": {
          "type": "one_to_many",
          "entity": "Order",
          "description": "Orders delivered to this address"
        }
      },
      "business_logic": {
        "multiple_addresses": "Users can have multiple delivery addresses",
        "default_selection": "One address can be marked as default",
        "validation": "Address format validation for Vietnam"
      }
    },
    "Review": {
      "description": "Product reviews and ratings from customers",
      "table": "reviews",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated review ID"
        },
        "userId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "Customer who wrote the review"
        },
        "productId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "products.id",
          "description": "Product being reviewed"
        },
        "rating": {
          "type": "SMALLINT",
          "required": true,
          "constraints": "rating BETWEEN 1 AND 5",
          "description": "Star rating (1-5)"
        },
        "comment": {
          "type": "TEXT",
          "description": "Written review comment"
        },
        "createdAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Review submission timestamp"
        }
      },
      "relationships": {
        "user": {
          "type": "many_to_one",
          "entity": "User",
          "description": "Review author"
        },
        "product": {
          "type": "many_to_one",
          "entity": "Product",
          "description": "Reviewed product"
        }
      },
      "business_logic": {
        "rating_system": "5-star rating system",
        "uniqueness": "One review per user per product",
        "moderation": "Reviews can be moderated by staff"
      }
    },
    "Voucher": {
      "description": "Discount vouchers with usage tracking and expiry",
      "table": "vouchers",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated voucher ID"
        },
        "code": {
          "type": "VARCHAR(50)",
          "required": true,
          "unique": true,
          "description": "Voucher code (e.g., 'WELCOME10')"
        },
        "discountValue": {
          "type": "NUMERIC(10,2)",
          "required": true,
          "constraints": "discountValue > 0",
          "description": "Discount amount (percentage or fixed)"
        },
        "discountType": {
          "type": "discount_type",
          "required": true,
          "description": "How discount is calculated"
        },
        "expiryDate": {
          "type": "DATE",
          "required": true,
          "description": "Voucher expiration date"
        },
        "minOrderValue": {
          "type": "NUMERIC(10,2)",
          "default": 0,
          "description": "Minimum order amount to use voucher"
        },
        "maxUses": {
          "type": "INTEGER",
          "description": "Maximum number of times voucher can be used"
        },
        "uses": {
          "type": "INTEGER",
          "default": 0,
          "description": "Current usage count"
        },
        "isActive": {
          "type": "BOOLEAN",
          "default": true,
          "description": "Whether voucher is currently active"
        }
      },
      "relationships": {
        "orders": {
          "type": "one_to_many",
          "entity": "Order",
          "description": "Orders that used this voucher"
        }
      },
      "business_logic": {
        "validation": "Check expiry date and usage limits",
        "application": "Applied during checkout process",
        "types": "Support both percentage and fixed amount discounts"
      }
    },
    "DeliveryUnit": {
      "description": "Delivery service providers with fees and time estimates",
      "table": "deliveryunits",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated delivery unit ID"
        },
        "name": {
          "type": "VARCHAR(100)",
          "required": true,
          "unique": true,
          "description": "Delivery service name"
        },
        "fee": {
          "type": "NUMERIC(10,2)",
          "constraints": "fee >= 0",
          "description": "Delivery fee in VND"
        },
        "estimatedTime": {
          "type": "VARCHAR(50)",
          "description": "Estimated delivery time (e.g., '2-3 business days')"
        },
        "isActive": {
          "type": "BOOLEAN",
          "default": true,
          "description": "Whether service is currently available"
        }
      },
      "relationships": {
        "orders": {
          "type": "one_to_many",
          "entity": "Order",
          "description": "Orders using this delivery service"
        }
      },
      "business_logic": {
        "selection": "Users choose delivery option during checkout",
        "pricing": "Delivery fee added to order total",
        "availability": "Can be enabled/disabled by admin"
      }
    },
    "Transaction": {
      "description": "Financial transactions for payments and refunds",
      "table": "transactions",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated transaction ID"
        },
        "userId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "User involved in transaction"
        },
        "orderId": {
          "type": "BIGINT",
          "foreign_key": "orders.id",
          "description": "Related order (if applicable)"
        },
        "amount": {
          "type": "NUMERIC(10,2)",
          "required": true,
          "constraints": "amount > 0",
          "description": "Transaction amount"
        },
        "type": {
          "type": "transaction_type",
          "required": true,
          "description": "Payment or refund"
        },
        "status": {
          "type": "transaction_status",
          "default": "failed",
          "description": "Transaction processing result"
        },
        "transactionReference": {
          "type": "VARCHAR(255)",
          "description": "External payment gateway reference"
        },
        "notes": {
          "type": "TEXT",
          "description": "Additional transaction notes"
        },
        "createdAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Transaction timestamp"
        }
      },
      "relationships": {
        "user": {
          "type": "many_to_one",
          "entity": "User",
          "description": "Transaction participant"
        },
        "order": {
          "type": "many_to_one",
          "entity": "Order",
          "description": "Related order"
        }
      },
      "business_logic": {
        "payment_flow": "Create transaction record for each payment attempt",
        "refunds": "Support refund processing for cancelled orders",
        "audit_trail": "Complete financial audit trail"
      }
    },
    "Message": {
      "description": "User-to-user messaging system for customer support",
      "table": "messages",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated message ID"
        },
        "senderId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "Message sender"
        },
        "receiverId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "Message recipient"
        },
        "content": {
          "type": "TEXT",
          "required": true,
          "description": "Message content"
        },
        "sentAt": {
          "type": "TIMESTAMP",
          "auto": true,
          "description": "Message sent timestamp"
        },
        "isRead": {
          "type": "BOOLEAN",
          "default": false,
          "description": "Whether message has been read"
        }
      },
      "relationships": {
        "sender": {
          "type": "many_to_one",
          "entity": "User",
          "description": "User who sent the message"
        },
        "receiver": {
          "type": "many_to_one",
          "entity": "User",
          "description": "User who receives the message"
        }
      },
      "business_logic": {
        "conversations": "Messages grouped by sender-receiver pairs",
        "notifications": "Real-time notifications for new messages",
        "customer_support": "Communication between customers and staff"
      }
    },
    "TimeSheet": {
      "description": "Staff working hours tracking and attendance",
      "table": "timesheets",
      "primary_key": "id",
      "fields": {
        "id": {
          "type": "BIGSERIAL",
          "description": "Auto-generated timesheet ID"
        },
        "staffId": {
          "type": "BIGINT",
          "required": true,
          "foreign_key": "users.id",
          "description": "Staff member (user with staff/admin role)"
        },
        "checkIn": {
          "type": "TIMESTAMP",
          "required": true,
          "description": "Work start time"
        },
        "checkOut": {
          "type": "TIMESTAMP",
          "description": "Work end time (null if still working)"
        },
        "date": {
          "type": "DATE",
          "required": true,
          "description": "Work date"
        },
        "hoursWorked": {
          "type": "NUMERIC(5,2)",
          "default": 0,
          "description": "Total hours worked"
        },
        "notes": {
          "type": "TEXT",
          "description": "Work notes or comments"
        }
      },
      "relationships": {
        "staff": {
          "type": "many_to_one",
          "entity": "User",
          "description": "Staff member"
        }
      },
      "business_logic": {
        "attendance": "Daily check-in/check-out tracking",
        "payroll": "Hours calculation for payroll processing",
        "reports": "Generate attendance reports"
      }
    }
  },
  "views": {
    "OrderSummary": {
      "description": "Comprehensive order view with customer, items, and delivery info",
      "base_tables": ["orders", "users", "addresses", "deliveryunits", "vouchers", "orderitems"],
      "key_fields": [
        "order_id",
        "customer_name",
        "email",
        "total_amount",
        "status",
        "delivery_address",
        "voucher_code",
        "item_count",
        "total_quantity"
      ]
    },
    "ProductRatings": {
      "description": "Product statistics with average ratings and follower counts",
      "base_tables": ["products", "reviews", "follows"],
      "key_fields": [
        "product_id",
        "product_name",
        "price",
        "average_rating",
        "review_count",
        "follower_count"
      ]
    }
  },
  "business_flows": {
    "customer_registration": {
      "steps": [
        "User provides email, password, name, phone",
        "System validates email uniqueness",
        "Account created with 'customer' role",
        "Cart automatically created for user"
      ]
    },
    "shopping_flow": {
      "steps": [
        "Customer browses products",
        "Adds products to cart with quantities",
        "Selects delivery address (or creates new one)",
        "Chooses delivery method and payment option",
        "Applies voucher if available",
        "Places order with 'pending' status",
        "Payment processing creates transaction",
        "Order status updated through workflow"
      ]
    },
    "order_processing": {
      "steps": [
        "Order placed (pending)",
        "Staff reviews and processes (processing)",
        "Items prepared and shipped (shipped)",
        "Customer receives order (completed)",
        "Alternative: Order cancelled at any stage before shipping"
      ]
    },
    "review_system": {
      "steps": [
        "Customer completes order",
        "System allows review submission",
        "Customer provides rating (1-5) and comment",
        "Review appears on product page",
        "Average rating calculated automatically"
      ]
    }
  },
  "sample_data_context": {
    "users": {
      "count": 6,
      "roles": {
        "admin": 1,
        "staff": 2,
        "customer": 3
      },
      "sample_credentials": {
        "admin": "admin@flowershop.com / password123",
        "staff": "bob.wilson@flowershop.com / password123",
        "customer": "john.doe@gmail.com / password123"
      }
    },
    "products": {
      "count": 10,
      "categories": ["roses", "lilies", "sunflowers", "tulips", "orchids", "carnations"],
      "price_range": "89,000 - 499,000 VND",
      "attributes": ["color", "size", "fragrance", "occasion", "season"]
    },
    "orders": {
      "count": 5,
      "statuses": ["completed", "shipped", "processing", "pending", "cancelled"],
      "payment_methods": ["credit_card", "bank_transfer", "cash_on_delivery", "wallet"]
    },
    "reviews": {
      "count": 10,
      "rating_distribution": "3-5 stars",
      "with_comments": true
    }
  },
  "api_endpoints": {
    "suggested_structure": {
      "/api/auth": "Authentication endpoints",
      "/api/users": "User management",
      "/api/products": "Product catalog",
      "/api/orders": "Order management",
      "/api/cart": "Shopping cart operations",
      "/api/reviews": "Product reviews",
      "/api/admin": "Administrative functions"
    }
  },
  "security_considerations": {
    "authentication": "JWT-based authentication",
    "authorization": "Role-based access control",
    "data_validation": "Input validation on all endpoints",
    "audit_trail": "AuditLog table for security monitoring",
    "password_security": "BCrypt password hashing"
  },
  "performance_optimizations": {
    "database_indexes": "Optimized for common query patterns",
    "connection_pooling": "HikariCP configuration",
    "lazy_loading": "JPA fetch strategies",
    "caching": "Can implement Redis caching for product data",
    "pagination": "Implement for product listings and order history"
  }
}
