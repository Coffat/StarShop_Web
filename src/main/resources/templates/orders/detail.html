<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{layouts/main :: layout('Chi tiết đơn hàng', 
          'Xem chi tiết đơn hàng và theo dõi trạng thái giao hàng của bạn.',
          ~{::link},
          ~{::content})}">

<head>
    <link rel="stylesheet" href="/css/orders.css">
</head>

<body>
<th:block th:fragment="content">
    <!-- Hero Header - Compact -->
    <section class="relative bg-gradient-to-br from-pink-50 via-white to-purple-50 border-b border-gray-100">
        <div class="absolute inset-0 opacity-5">
            <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%23F06292\' fill-opacity=\'1\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
        </div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 py-8">
            <div class="flex items-center justify-between">
                <div>
                    <div class="inline-flex items-center gap-2 bg-white/80 backdrop-blur-sm px-3 py-1.5 rounded-full shadow-sm border border-pink-100 mb-3">
                        <svg class="w-4 h-4 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        <span class="text-xs font-semibold text-gray-700" data-translate="order-detail-badge">Chi tiết đơn hàng</span>
                    </div>
                    
                    <h1 class="text-3xl font-bold text-gray-900 mb-2" data-translate="order-title">
                        Đơn hàng 
                        <span class="bg-gradient-to-r from-pink-500 via-rose-500 to-purple-600 bg-clip-text text-transparent">#<span th:text="${order.order.id}">123</span></span>
                    </h1>
                    
                    <p class="text-sm text-gray-600">
                        <span data-translate="order-placed-at">Đặt hàng lúc</span> <span th:text="${#temporals.format(order.order.orderDate, 'dd/MM/yyyy HH:mm')}">15/10/2024 14:30</span>
                    </p>
                </div>
                
                <a href="/account/orders" class="inline-flex items-center gap-2 px-4 py-2 bg-white text-gray-700 rounded-xl border border-gray-200 hover:border-pink-300 transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    <span data-translate="back">Quay lại</span>
                </a>
            </div>
        </div>
    </section>

    <!-- Order Content -->
    <section class="py-8 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <!-- Payment Success/Error Messages -->
            <div th:if="${paymentSuccess}" class="bg-green-50 border border-green-200 rounded-xl p-4 mb-6 flex items-start gap-3">
                <svg class="w-6 h-6 text-green-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div>
                    <h3 class="font-semibold text-green-900 mb-1" data-translate="payment-success">Thanh toán thành công!</h3>
                    <p class="text-sm text-green-700" th:text="${successMessage}">Đơn hàng của bạn đang được xử lý.</p>
                    <p th:if="${transactionId}" class="text-xs text-green-600 mt-1"><span data-translate="transaction-id">Mã giao dịch</span>: <span th:text="${transactionId}"></span></p>
                </div>
            </div>
            
            <div th:if="${paymentError}" class="bg-red-50 border border-red-200 rounded-xl p-4 mb-6 flex items-start gap-3">
                <svg class="w-6 h-6 text-red-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div>
                    <h3 class="font-semibold text-red-900 mb-1" data-translate="payment-failed">Thanh toán thất bại</h3>
                    <p class="text-sm text-red-700" th:text="${errorMessage}">Vui lòng thử lại.</p>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Main Content -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Order Status -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
                        <h2 class="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <svg class="w-5 h-5 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span data-translate="order-status">Trạng thái đơn hàng</span>
                        </h2>
                        
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600 mb-2" data-translate="current-status">Trạng thái hiện tại</p>
                                <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold border" 
                                      th:class="${order.order.status == 'PENDING' ? 'bg-yellow-100 text-yellow-700 border-yellow-200' : 
                                    (order.order.status == 'PROCESSING' ? 'bg-blue-100 text-blue-700 border-blue-200' : 
                                    (order.order.status == 'SHIPPED' ? 'bg-purple-100 text-purple-700 border-purple-200' : 
                                    (order.order.status == 'COMPLETED' ? 'bg-green-100 text-green-700 border-green-200' : 
                                    'bg-red-100 text-red-700 border-red-200')))}"
                                      th:data-status="${order.order.status}"
                                      id="orderStatusBadge">
                                    <span th:text="${order.order.statusDisplayName}">Chờ xử lý</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Order Items -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
                        <h2 class="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <svg class="w-5 h-5 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                            </svg>
                            <span data-translate="products-ordered">Sản phẩm đã đặt</span>
                        </h2>
                        
                        <div class="space-y-4">
                            <div th:each="item : ${order.order.orderItems}" class="flex items-center gap-4 p-4 bg-gray-50 rounded-xl">
                                <div class="w-20 h-20 flex-shrink-0">
                                    <img th:src="${item.productImage}" th:alt="${item.productName}" 
                                         class="w-full h-full object-cover rounded-lg"
                                         onerror="this.src='/images/placeholder.jpg'">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-semibold text-gray-900 truncate" th:text="${item.productName}">Tên sản phẩm</h4>
                                    <p class="text-sm text-gray-600 mt-1">
                                        <span data-translate="quantity">Số lượng</span>: <span th:text="${item.quantity}">1</span> × 
                                        <span th:text="${#numbers.formatDecimal(item.price, 0, 'COMMA', 0, 'POINT')}">500,000</span>₫
                                    </p>
                                    
                                    <!-- Review Status & Button -->
                                    <div class="mt-3 flex items-center gap-3">
                                        <!-- Review Status -->
                                        <div th:if="${item.reviewed}" class="flex items-center gap-1 text-green-600">
                                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                            </svg>
                                            <span class="text-xs font-medium" data-translate="reviewed">Đã đánh giá</span>
                                        </div>
                                        
                                        <!-- Review Button -->
                                        <button th:if="${item.canReview}" 
                                                th:data-order-item-id="${item.id}"
                                                th:data-product-name="${item.productName}"
                                                th:data-product-image="${item.productImage}"
                                                onclick="openProductReviewModal(this.dataset.orderItemId, this.dataset.productName, this.dataset.productImage)"
                                                class="inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-pink-600 bg-pink-50 border border-pink-200 rounded-lg hover:bg-pink-100 transition-colors duration-200">
                                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                            </svg>
                                            <span data-translate="review-product">Đánh giá</span>
                                        </button>
                                        
                                        <!-- Cannot Review Reason -->
                                        <span th:if="${!item.canReview && !item.reviewed}" 
                                              class="text-xs text-gray-500" 
                                              th:text="${item.reviewReason ?: 'Chưa thể đánh giá'}">Chưa thể đánh giá</span>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold text-gray-900" th:text="${#numbers.formatDecimal(item.price * item.quantity, 0, 'COMMA', 0, 'POINT')} + '₫'">500,000₫</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
                
                <!-- Sidebar -->
                <div class="space-y-6">
                    
                    <!-- Order Summary -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
                        <h2 class="text-lg font-bold text-gray-900 mb-4" data-translate="order-summary">Tóm tắt đơn hàng</h2>
                        
                        <div class="space-y-3">
                            <!-- Calculate subtotal from order items -->
                            <div class="flex justify-between text-sm" th:with="subtotal=${#aggregates.sum(order.order.orderItems.![price * quantity])}">
                                <span class="text-gray-600" data-translate="subtotal">Tạm tính</span>
                                <span class="font-medium" th:text="${#numbers.formatDecimal(subtotal, 0, 'COMMA', 0, 'POINT')} + '₫'">500,000₫</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600" data-translate="shipping-fee">Phí vận chuyển</span>
                                <span class="font-medium" th:text="${order.order.deliveryFee != null ? #numbers.formatDecimal(order.order.deliveryFee, 0, 'COMMA', 0, 'POINT') + '₫' : 'Miễn phí'}">30,000₫</span>
                            </div>
                            <div th:if="${order.order.discountAmount != null && order.order.discountAmount > 0}" class="flex justify-between text-sm text-green-600">
                                <span data-translate="discount">Giảm giá</span>
                                <span class="font-medium">-<span th:text="${#numbers.formatDecimal(order.order.discountAmount, 0, 'COMMA', 0, 'POINT')}">50,000</span>₫</span>
                            </div>
                            <div class="border-t border-gray-200 pt-3 flex justify-between">
                                <span class="font-bold text-gray-900" data-translate="total">Tổng cộng</span>
                                <span class="text-2xl font-bold bg-gradient-to-r from-pink-500 to-purple-600 bg-clip-text text-transparent" 
                                      th:text="${#numbers.formatDecimal(order.order.totalAmount, 0, 'COMMA', 0, 'POINT')} + '₫'">480,000₫</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Delivery Info -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
                        <h2 class="text-lg font-bold text-gray-900 mb-4" data-translate="shipping-info">Thông tin giao hàng</h2>
                        
                        <div class="space-y-3 text-sm">
                            <div>
                                <p class="text-gray-600 mb-1" data-translate="recipient">Người nhận</p>
                                <p class="font-medium text-gray-900" th:text="${order.order.userFullName}">Nguyễn Văn A</p>
                            </div>
                            <div>
                                <p class="text-gray-600 mb-1" data-translate="phone">Số điện thoại</p>
                                <p class="font-medium text-gray-900" th:text="${order.order.userPhone ?: 'Chưa cập nhật'}">0123456789</p>
                            </div>
                            <div>
                                <p class="text-gray-600 mb-1" data-translate="delivery-address">Địa chỉ giao hàng</p>
                                <p class="font-medium text-gray-900" th:text="${order.order.addressDetails}">123 Đường ABC, Phường XYZ, Quận 1, TP.HCM</p>
                            </div>
                            <div th:if="${order.order.notes}">
                                <p class="text-gray-600 mb-1" data-translate="notes">Ghi chú</p>
                                <p class="font-medium text-gray-900" th:text="${order.order.notes}">Giao giờ hành chính</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payment Method -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
                        <h2 class="text-lg font-bold text-gray-900 mb-4" data-translate="payment-method">Phương thức thanh toán</h2>
                        <div class="space-y-2">
                            <p class="text-sm font-medium text-gray-900" th:text="${order.order.paymentMethodDisplayName}">Thanh toán khi nhận hàng</p>
                            <div th:if="${order.order.paymentMethod.name() == 'MOMO' and order.order.momoTransId}" class="text-xs text-gray-600">
                                <span data-translate="momo-transaction-id">Mã giao dịch MoMo</span>: <span th:text="${order.order.momoTransId}" class="font-mono">123456789</span>
                            </div>
                        </div>
                    </div>
                    
                </div>
                
            </div>
        </div>
    </section>

    <!-- Product Review Modal -->
    <div id="productReviewModal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="productReviewModalLabel" aria-hidden="true">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300" id="productModalBackdrop"></div>
        
        <!-- Modal -->
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="relative w-full max-w-md bg-white rounded-2xl shadow-xl transform transition-all duration-300 scale-100 overflow-hidden" id="productModalContent">
                
                <!-- Header -->
                <div class="bg-gradient-to-r from-pink-50 to-purple-50 px-6 py-4 border-b border-gray-200 rounded-t-2xl">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold text-gray-900 flex items-center gap-2" id="productReviewModalLabel">
                            <svg class="w-6 h-6 text-pink-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                            </svg>
                            <span data-translate="review-product">Đánh giá sản phẩm</span>
                        </h3>
                        <button type="button" class="text-gray-400 hover:text-gray-600 transition-colors duration-200" id="closeProductModalBtn">
                            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Body -->
                <div class="px-6 py-6">
                    <!-- Product Info -->
                    <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-xl mb-6">
                        <img id="productReviewImage" src="" alt="" class="w-16 h-16 object-cover rounded-lg">
                        <div>
                            <h4 id="productReviewName" class="font-semibold text-gray-900"></h4>
                            <p class="text-sm text-gray-600" data-translate="from-order">Từ đơn hàng này</p>
                        </div>
                    </div>

                    <!-- Rating Section -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-3" data-translate="your-rating">Đánh giá của bạn</label>
                        <div class="flex items-center gap-1" id="productRatingStars">
                            <button type="button" class="text-gray-300 hover:text-yellow-400 transition-colors duration-200" data-rating="1">
                                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                </svg>
                            </button>
                            <button type="button" class="text-gray-300 hover:text-yellow-400 transition-colors duration-200" data-rating="2">
                                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                </svg>
                            </button>
                            <button type="button" class="text-gray-300 hover:text-yellow-400 transition-colors duration-200" data-rating="3">
                                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                </svg>
                            </button>
                            <button type="button" class="text-gray-300 hover:text-yellow-400 transition-colors duration-200" data-rating="4">
                                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                </svg>
                            </button>
                            <button type="button" class="text-gray-300 hover:text-yellow-400 transition-colors duration-200" data-rating="5">
                                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                                </svg>
                            </button>
                        </div>
                        <p class="text-sm text-gray-600 mt-2" id="productRatingText" data-translate="choose-rating">Chọn số sao để đánh giá</p>
                    </div>

                    <!-- Comment Section -->
                    <div class="mb-6">
                        <label for="productReviewComment" class="block text-sm font-medium text-gray-700 mb-2">
                            <span data-translate="comment-optional">Nhận xét (tùy chọn)</span>
                        </label>
                        <textarea id="productReviewComment" 
                                  class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 resize-none transition-colors duration-200" 
                                  rows="4" 
                                  data-translate-placeholder="share-your-experience"
                                  placeholder="Chia sẻ trải nghiệm của bạn về sản phẩm này..."></textarea>
                    </div>

                    <!-- Media Upload Section -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <span data-translate="upload-media">Đính kèm ảnh/video (tùy chọn)</span>
                        </label>
                        
                        <!-- Upload Area -->
                        <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-pink-400 transition-colors duration-200" 
                             id="uploadArea">
                            <input type="file" id="mediaUpload" 
                                   class="hidden" 
                                   accept="image/*,video/*" 
                                   multiple>
                            
                            <div class="space-y-2">
                                <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                                <div class="text-sm text-gray-600">
                                    <label for="mediaUpload" class="relative cursor-pointer bg-white rounded-md font-medium text-pink-600 hover:text-pink-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-pink-500">
                                        <span data-translate="click-to-upload">Nhấn để tải lên</span>
                                        <input type="file" class="sr-only" multiple accept="image/*,video/*">
                                    </label>
                                    <span class="pl-1" data-translate="or-drag-drop">hoặc kéo thả</span>
                                </div>
                                <p class="text-xs text-gray-500" data-translate="upload-hint">
                                    PNG, JPG, GIF, MP4, MOV lên đến 10MB mỗi file. Tối đa 5 file.
                                </p>
                                <p class="text-xs text-gray-400 mt-1 italic">
                                    Bạn có thể bỏ qua phần này và chỉ đánh giá bằng văn bản
                                </p>
                            </div>
                        </div>

                        <!-- File Counter -->
                        <div id="fileCounter" class="mt-2 text-sm text-gray-600 hidden">
                            <span id="fileCount">0</span>/5 file đã chọn
                        </div>

                        <!-- Preview Area -->
                        <div id="mediaPreview" class="mt-4 grid grid-cols-2 gap-2 hidden">
                            <!-- Media previews will be inserted here -->
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="button" id="submitProductReviewBtn" 
                            class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 px-6 rounded-xl font-semibold hover:from-pink-600 hover:to-purple-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled>
                        <svg class="w-4 h-4 inline mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"/>
                        </svg>
                        <span data-translate="submit-review">Gửi đánh giá</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script th:src="@{/js/notifications.js}"></script>
    <script th:src="@{/js/orders-detail.js}"></script>

</th:block>
</body>
</html>
