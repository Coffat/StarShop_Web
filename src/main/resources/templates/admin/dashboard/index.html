<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- Dashboard Content -->
    <div class="space-y-6">
        
        <!-- Statistics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Total Revenue -->
            <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white transform hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-blue-100 text-sm font-medium">Tổng doanh thu</p>
                        <p class="text-3xl font-bold mt-2" th:text="${#numbers.formatCurrency(stats.totalRevenue)}">0₫</p>
                        <div class="flex items-center mt-2">
                            <i class="fas fa-chart-line text-green-300 text-sm mr-1"></i>
                            <span class="text-green-300 text-sm font-medium" th:text="${#numbers.formatCurrency(stats.monthlyRevenue)}">0₫</span>
                            <span class="text-blue-100 text-sm ml-1">tháng này</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-chart-line text-2xl"></i>
                    </div>
                </div>
            </div>
            
            <!-- Total Orders -->
            <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white transform hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-green-100 text-sm font-medium">Tổng đơn hàng</p>
                        <p class="text-3xl font-bold mt-2" th:text="${stats.totalOrders}">0</p>
                        <div class="flex items-center mt-2">
                            <i class="fas fa-clock text-yellow-300 text-sm mr-1"></i>
                            <span class="text-yellow-300 text-sm font-medium" th:text="${stats.pendingOrders}">0</span>
                            <span class="text-green-100 text-sm ml-1">đang chờ xử lý</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-shopping-cart text-2xl"></i>
                    </div>
                </div>
            </div>
            
            <!-- Total Customers -->
            <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white transform hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-purple-100 text-sm font-medium">Tổng khách hàng</p>
                        <p class="text-3xl font-bold mt-2" th:text="${stats.totalUsers}">0</p>
                        <div class="flex items-center mt-2">
                            <i class="fas fa-arrow-up text-green-300 text-sm mr-1"></i>
                            <span class="text-green-300 text-sm font-medium">+15.3%</span>
                            <span class="text-purple-100 text-sm ml-1">so với tháng trước</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-users text-2xl"></i>
                    </div>
                </div>
            </div>
            
            <!-- Total Products -->
            <div class="bg-gradient-to-br from-pink-500 to-pink-600 rounded-xl shadow-lg p-6 text-white transform hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-pink-100 text-sm font-medium">Tổng sản phẩm</p>
                        <p class="text-3xl font-bold mt-2" th:text="${stats.totalProducts}">0</p>
                        <div class="flex items-center mt-2">
                            <i class="fas fa-plus text-green-300 text-sm mr-1"></i>
                            <span class="text-green-300 text-sm font-medium" th:text="${stats.completedOrders}">0</span>
                            <span class="text-pink-100 text-sm ml-1">đơn hoàn thành</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-box text-2xl"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Revenue Chart -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Doanh thu theo tháng</h3>
                    <div class="flex space-x-2">
                        <button class="px-3 py-1 text-sm bg-primary-100 text-primary-700 rounded-lg hover:bg-primary-200 transition-colors duration-200">6 tháng</button>
                        <button class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors duration-200">1 năm</button>
                    </div>
                </div>
                <div class="h-80">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
            
            <!-- Orders Status Chart -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Trạng thái đơn hàng</h3>
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        <span class="text-sm text-gray-600">Hoàn thành</span>
                        <div class="w-3 h-3 bg-yellow-500 rounded-full ml-4"></div>
                        <span class="text-sm text-gray-600">Đang xử lý</span>
                        <div class="w-3 h-3 bg-red-500 rounded-full ml-4"></div>
                        <span class="text-sm text-gray-600">Đã hủy</span>
                    </div>
                </div>
                <div class="h-80">
                    <canvas id="ordersChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Recent Orders & Top Products -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Recent Orders -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Đơn hàng gần đây</h3>
                    <a href="/admin/orders" class="text-primary-600 hover:text-primary-700 text-sm font-medium transition-colors duration-200">
                        Xem tất cả <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
                <div class="space-y-4">
                    <!-- Recent Orders from Backend -->
                    <div th:if="${stats.recentOrders != null and !#lists.isEmpty(stats.recentOrders)}">
                        <div th:each="order : ${stats.recentOrders}" 
                             class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-shopping-bag text-primary-600"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900" th:text="'ORDER-' + ${order.id}">ORDER-001</p>
                                    <p class="text-sm text-gray-500" th:text="${order.user != null ? order.user.fullName : 'N/A'}">Customer Name</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-medium text-gray-900" th:text="${#numbers.formatCurrency(order.totalAmount)}">0₫</p>
                                <span th:class="${'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + 
                                    (order.status.name() == 'COMPLETED' ? 'bg-green-100 text-green-800' : 
                                     order.status.name() == 'PENDING' ? 'bg-yellow-100 text-yellow-800' :
                                     order.status.name() == 'PROCESSING' ? 'bg-blue-100 text-blue-800' :
                                     order.status.name() == 'SHIPPED' ? 'bg-purple-100 text-purple-800' :
                                     'bg-red-100 text-red-800')}"
                                      th:text="${order.status.getDisplayName()}">
                                    Status
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- No orders message -->
                    <div th:if="${stats.recentOrders == null or #lists.isEmpty(stats.recentOrders)}" 
                         class="text-center py-8 text-gray-500">
                        <i class="fas fa-shopping-cart text-3xl mb-2"></i>
                        <p>Chưa có đơn hàng nào</p>
                    </div>
                </div>
            </div>
            
            <!-- Top Products -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Sản phẩm bán chạy</h3>
                    <a href="/admin/products" class="text-primary-600 hover:text-primary-700 text-sm font-medium transition-colors duration-200">
                        Xem tất cả <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
                <div class="space-y-4">
                    <!-- Product Item -->
                    <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                        <img src="https://via.placeholder.com/60x60/ec4899/ffffff?text=🌹" alt="Product" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <p class="font-medium text-gray-900">Hoa hồng đỏ</p>
                            <p class="text-sm text-gray-500">Đã bán: 156 sản phẩm</p>
                        </div>
                        <div class="text-right">
                            <p class="font-medium text-gray-900">450,000₫</p>
                            <div class="flex items-center mt-1">
                                <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-primary-600 h-2 rounded-full" style="width: 85%"></div>
                                </div>
                                <span class="text-xs text-gray-500">85%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                        <img src="https://via.placeholder.com/60x60/ec4899/ffffff?text=🌻" alt="Product" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <p class="font-medium text-gray-900">Hoa hướng dương</p>
                            <p class="text-sm text-gray-500">Đã bán: 134 sản phẩm</p>
                        </div>
                        <div class="text-right">
                            <p class="font-medium text-gray-900">320,000₫</p>
                            <div class="flex items-center mt-1">
                                <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-primary-600 h-2 rounded-full" style="width: 72%"></div>
                                </div>
                                <span class="text-xs text-gray-500">72%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                        <img src="https://via.placeholder.com/60x60/ec4899/ffffff?text=🌷" alt="Product" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <p class="font-medium text-gray-900">Hoa tulip</p>
                            <p class="text-sm text-gray-500">Đã bán: 98 sản phẩm</p>
                        </div>
                        <div class="text-right">
                            <p class="font-medium text-gray-900">280,000₫</p>
                            <div class="flex items-center mt-1">
                                <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-primary-600 h-2 rounded-full" style="width: 58%"></div>
                                </div>
                                <span class="text-xs text-gray-500">58%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Chart.js Scripts -->
    <script th:inline="javascript">
        // Get data from backend
        const revenueChartData = /*[[${revenueChart}]]*/ {};
        const orderStatusChartData = /*[[${orderStatusChart}]]*/ {};
        
        // Revenue Chart
        const revenueCtx = document.getElementById('revenueChart').getContext('2d');
        new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: revenueChartData.months || ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6'],
                datasets: [{
                    label: 'Doanh thu (VNĐ)',
                    data: revenueChartData.revenues || [0, 0, 0, 0, 0, 0],
                    borderColor: '#ec4899',
                    backgroundColor: 'rgba(236, 72, 153, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#ec4899',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#f3f4f6'
                        },
                        ticks: {
                            color: '#6b7280'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#6b7280'
                        }
                    }
                }
            }
        });
        
        // Orders Status Chart
        const ordersCtx = document.getElementById('ordersChart').getContext('2d');
        new Chart(ordersCtx, {
            type: 'doughnut',
            data: {
                labels: ['Hoàn thành', 'Đang xử lý', 'Đang giao', 'Chờ xử lý', 'Đã hủy'],
                datasets: [{
                    data: [
                        orderStatusChartData.completed || 0,
                        orderStatusChartData.processing || 0,
                        orderStatusChartData.shipped || 0,
                        orderStatusChartData.pending || 0,
                        orderStatusChartData.cancelled || 0
                    ],
                    backgroundColor: ['#10b981', '#3b82f6', '#8b5cf6', '#f59e0b', '#ef4444'],
                    borderWidth: 0,
                    cutout: '70%'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    </script>
</body>
</html>
