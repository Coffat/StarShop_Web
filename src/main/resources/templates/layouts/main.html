<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security" 
      lang="vi" 
      th:fragment="layout (title, description, extraCSS, content)">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title != null ? title + ' - StarShop üå∏' : 'StarShop üå∏ - C·ª≠a h√†ng hoa t∆∞∆°i'}">StarShop üå∏</title>
    
    <!-- Meta Tags for SEO -->
    <meta name="description" th:content="${description != null ? description : 'StarShop - C·ª≠a h√†ng hoa t∆∞∆°i, ƒë·∫πp, ch·∫•t l∆∞·ª£ng cao. Giao h√†ng nhanh ch√≥ng to√†n qu·ªëc.'}">
    <meta name="keywords" content="hoa t∆∞∆°i, shop hoa, StarShop, hoa sinh nh·∫≠t, hoa t√¨nh y√™u, hoa c∆∞·ªõi, hoa khai tr∆∞∆°ng">
    <meta name="author" content="StarShop">
    
    <!-- CSRF Token -->
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" th:content="${title != null ? title + ' - StarShop üå∏' : 'StarShop üå∏ - C·ª≠a h√†ng hoa t∆∞∆°i'}">
    <meta property="og:description" th:content="${description != null ? description : 'StarShop - C·ª≠a h√†ng hoa t∆∞∆°i, ƒë·∫πp, ch·∫•t l∆∞·ª£ng cao. Giao h√†ng nhanh ch√≥ng to√†n qu·ªëc.'}">
    <meta property="og:image" content="/images/starshop-og.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" th:content="${title != null ? title + ' - StarShop üå∏' : 'StarShop üå∏ - C·ª≠a h√†ng hoa t∆∞∆°i'}">
    <meta property="twitter:description" th:content="${description != null ? description : 'StarShop - C·ª≠a h√†ng hoa t∆∞∆°i, ƒë·∫πp, ch·∫•t l∆∞·ª£ng cao. Giao h√†ng nhanh ch√≥ng to√†n qu·ªëc.'}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Custom Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#EC407A',
                            light: '#F8BBD9',
                            dark: '#AD1457',
                            hover: '#E91E63'
                        },
                        secondary: '#ffcccb',
                        accent: '#e8f5e8',
                        cream: '#fdf8f5',
                        sage: '#9caf88',
                        lavender: '#e6e6fa',
                        peach: '#ffeaa7',
                        'rose-gold': '#f4c2a1'
                    },
                    fontFamily: {
                        'roboto': ['Roboto', 'sans-serif']
                    },
                    boxShadow: {
                        'soft': '0 4px 20px rgba(248, 180, 217, 0.15)',
                        'hover': '0 8px 25px rgba(236, 64, 122, 0.2)'
                    }
                }
            }
        }
    </script>
    
    <!-- Heroicons CSS Helper -->
    <link rel="stylesheet" href="/css/heroicons.css">
    
    <!-- AOS - Animate On Scroll Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Google Fonts - Roboto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="/css/main.css">
    
    <!-- Page-specific CSS -->
    <th:block th:replace="${extraCSS}"></th:block>
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "StarShop",
        "description": "C·ª≠a h√†ng hoa t∆∞∆°i ch·∫•t l∆∞·ª£ng cao",
        "url": "https://starshop.vn",
        "logo": "https://starshop.vn/images/logo.png",
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+84-901-234-567",
            "contactType": "customer service",
            "availableLanguage": ["Vietnamese"]
        },
        "sameAs": [
            "https://facebook.com/starshop",
            "https://instagram.com/starshop",
            "https://tiktok.com/@starshop"
        ]
    }
    </script>
</head>
<body>
    <!-- Background Decoration -->
    <div class="bg-decoration"></div>
    
    <!-- Floating Petals Animation -->
    <div class="floating-petals">
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
        <div class="petal"></div>
    </div>
    
    <!-- Header -->
    <div th:replace="~{fragments/header :: header}"></div>
    
    <!-- Main Content -->
    <main id="main-content">
        <!-- Page-specific content goes here -->
        <th:block th:replace="${content}">
            <!-- Content will be inserted here -->
        </th:block>
    </main>
    
    <!-- Footer -->
    <div th:replace="~{fragments/footer :: footer}"></div>
    
    <!-- Back to Top Button -->
    <button type="button" id="backToTop" title="L√™n ƒë·∫ßu trang"
            class="fixed bottom-8 right-8 w-12 h-12 rounded-full bg-gradient-to-r from-primary to-primary-hover text-white shadow-lg hover:shadow-hover transition-all duration-300 opacity-0 invisible z-50">
        <svg class="hero-icon mx-auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z" clip-rule="evenodd" />
        </svg>
    </button>
    
    <!-- Alpine.js for interactive components -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- AOS - Animate On Scroll Library -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Main JavaScript -->
    <script src="/js/main.js"></script>
    
    <!-- Language Switcher JS -->
    <script src="/js/language-switcher.js"></script>
    
    <!-- Page-specific JavaScript -->
    <th:block th:if="${additionalJS}" th:each="js : ${additionalJS}">
        <script th:src="@{${js}}"></script>
    </th:block>
    
    <!-- Analytics & Tracking (Add your tracking codes here) -->
    <!-- Google Analytics -->
    <!-- Facebook Pixel -->
    <!-- Other tracking codes -->
</body>
</html>

<style>
/* Skip to main content for accessibility */
.skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: #EC407A;
    color: white;
    padding: 8px;
    text-decoration: none;
    border-radius: 4px;
    z-index: 1001;
    transition: top 0.15s ease-in-out;
}

.skip-link:focus {
    top: 6px;
    color: white;
}
</style>

<script>
// Back to Top Button Functionality
document.addEventListener('DOMContentLoaded', function() {
    const backToTopBtn = document.getElementById('backToTop');
    
    // Show/hide button based on scroll position
    window.addEventListener('scroll', function() {
        if (window.pageYOffset > 300) {
            backToTopBtn.classList.remove('opacity-0', 'invisible');
            backToTopBtn.classList.add('opacity-100', 'visible');
        } else {
            backToTopBtn.classList.add('opacity-0', 'invisible');
            backToTopBtn.classList.remove('opacity-100', 'visible');
        }
    });
    
    // Smooth scroll to top
    backToTopBtn.addEventListener('click', function() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });
});

// Enhanced loading states
window.addEventListener('load', function() {
    document.body.classList.add('loaded');
});

// Preload critical resources
const preloadResource = (href, as, type = null) => {
    const link = document.createElement('link');
    link.rel = 'preload';
    link.href = href;
    link.as = as;
    if (type) link.type = type;
    document.head.appendChild(link);
};

// Preload fonts
preloadResource('https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2', 'font', 'font/woff2');
</script>
