# üöÄ H∆∞·ªõng D·∫´n Deploy v√† Maintain ·ª®ng D·ª•ng Flower Shop tr√™n AWS ECS

## üìã M·ª•c L·ª•c
- [Th√¥ng Tin H·ªá Th·ªëng](#th√¥ng-tin-h·ªá-th·ªëng)
- [Ki·∫øn Tr√∫c Tri·ªÉn Khai](#ki·∫øn-tr√∫c-tri·ªÉn-khai)
- [C·∫≠p Nh·∫≠t Code Backend](#c·∫≠p-nh·∫≠t-code-backend)
- [Qu·∫£n L√Ω Database](#qu·∫£n-l√Ω-database)
- [Qu·∫£n L√Ω Bi·∫øn M√¥i Tr∆∞·ªùng](#qu·∫£n-l√Ω-bi·∫øn-m√¥i-tr∆∞·ªùng)
- [Monitoring v√† Logs](#monitoring-v√†-logs)
- [Troubleshooting](#troubleshooting)
- [Backup v√† Restore](#backup-v√†-restore)

---

## üåê Th√¥ng Tin H·ªá Th·ªëng

### **Th√¥ng tin truy c·∫≠p:**
- **Domain**: http://starshop-hcmute.duckdns.org
- **Public IP hi·ªán t·∫°i**: 16.176.203.154
- **Port**: 80 (HTTP)
- **AWS Region**: ap-southeast-2 (Sydney)
- **AWS Account ID**: 486918185988

### **T√†i nguy√™n AWS:**

| T√†i nguy√™n | T√™n | ID/ARN |
|------------|-----|--------|
| ECS Cluster | flower-shop-cluster | - |
| ECS Service | flower-shop-service | - |
| Task Definition | flower-shop-task | Revision: 7 |
| ECR Repository | flower_shop_app | 486918185988.dkr.ecr.ap-southeast-2.amazonaws.com/flower_shop_app |
| RDS Database | flower-shop-db-instance | flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com |
| Security Group (ECS) | flower-shop-sg | sg-09b68a2f85c567cf6 |
| Security Group (RDS) | - | sg-028b57fab2c0669a0 |
| CloudWatch Log Group | /ecs/flower-shop-task | - |

### **Database:**
- **Engine**: PostgreSQL 17.4
- **Endpoint**: flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com:5432
- **Database Name**: flower_shop_system
- **Username**: flower_admin
- **Password**: flower_password_2024

### **DuckDNS:**
- **Domain**: starshop-hcmute.duckdns.org
- **Token**: 31b32e5b-c7a7-41f6-8474-0a1b46f57526

---

## üèóÔ∏è Ki·∫øn Tr√∫c Tri·ªÉn Khai

```
Internet
    ‚Üì
DuckDNS (starshop-hcmute.duckdns.org)
    ‚Üì
Public IP (16.176.203.154:80)
    ‚Üì
Security Group (sg-09b68a2f85c567cf6)
    ‚Üì
ECS Fargate (ARM64)
    ‚îú‚îÄ‚îÄ Container: flower-shop-container
    ‚îú‚îÄ‚îÄ Image: ECR (flower_shop_app:latest)
    ‚îî‚îÄ‚îÄ Logs: CloudWatch (/ecs/flower-shop-task)
    ‚Üì
Security Group (sg-028b57fab2c0669a0)
    ‚Üì
RDS PostgreSQL (flower-shop-db-instance)
```

---

## üîÑ C·∫≠p Nh·∫≠t Code Backend

### **Quy tr√¨nh c·∫≠p nh·∫≠t khi s·ª≠a code:**

#### **B∆∞·ªõc 1: S·ª≠a code v√† test local**
```bash
# Test ·ª©ng d·ª•ng tr√™n local tr∆∞·ªõc
./mvnw spring-boot:run

# Ho·∫∑c build v√† ch·∫°y v·ªõi Docker
docker build -t flower_shop_app .
docker run -p 8080:8080 flower_shop_app
```

#### **B∆∞·ªõc 2: Build Docker Image m·ªõi**
```bash
# Build image cho ARM64 (v√¨ ECS ƒëang d√πng ARM64)
docker buildx build --platform linux/arm64 -t flower_shop_app .

# Ho·∫∑c n·∫øu mu·ªën build cho c·∫£ AMD64 v√† ARM64
docker buildx build --platform linux/amd64,linux/arm64 -t flower_shop_app .
```

#### **B∆∞·ªõc 3: Tag v√† Push l√™n ECR**
```bash
# 1. ƒêƒÉng nh·∫≠p v√†o ECR
aws ecr get-login-password --region ap-southeast-2 | \
  docker login --username AWS --password-stdin \
  486918185988.dkr.ecr.ap-southeast-2.amazonaws.com

# 2. Tag image
docker tag flower_shop_app:latest \
  486918185988.dkr.ecr.ap-southeast-2.amazonaws.com/flower_shop_app:latest

# 3. Push l√™n ECR
docker push 486918185988.dkr.ecr.ap-southeast-2.amazonaws.com/flower_shop_app:latest
```

#### **B∆∞·ªõc 4: Deploy l√™n ECS**
```bash
# Force new deployment ƒë·ªÉ ECS pull image m·ªõi
aws ecs update-service \
  --cluster flower-shop-cluster \
  --service flower-shop-service \
  --force-new-deployment \
  --region ap-southeast-2
```

#### **B∆∞·ªõc 5: Ki·ªÉm tra deployment**
```bash
# Xem tr·∫°ng th√°i service
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2 \
  --query 'services[0].{Status:status,Running:runningCount,Pending:pendingCount}' \
  --output table

# ƒê·ª£i kho·∫£ng 2-3 ph√∫t ƒë·ªÉ container m·ªõi kh·ªüi ƒë·ªông
sleep 120

# Xem logs
aws logs tail /ecs/flower-shop-task --follow --region ap-southeast-2
```

#### **B∆∞·ªõc 6: C·∫≠p nh·∫≠t DuckDNS (n·∫øu IP thay ƒë·ªïi)**
```bash
# Ch·∫°y script t·ª± ƒë·ªông c·∫≠p nh·∫≠t
./update-duckdns.sh
```

#### **B∆∞·ªõc 7: Verify deployment**
```bash
# Test HTTP
curl -I http://starshop-hcmute.duckdns.org

# Ho·∫∑c m·ªü tr√¨nh duy·ªát
open http://starshop-hcmute.duckdns.org
```

---

## üîÑ Quy Tr√¨nh C·∫≠p Nh·∫≠t Nhanh (Script)

T·∫°o file `deploy.sh` ƒë·ªÉ t·ª± ƒë·ªông h√≥a:

```bash
#!/bin/bash

echo "üöÄ B·∫Øt ƒë·∫ßu deploy..."

# 1. Build image
echo "üì¶ Building Docker image..."
docker buildx build --platform linux/arm64 -t flower_shop_app .

# 2. Login ECR
echo "üîê Logging into ECR..."
aws ecr get-login-password --region ap-southeast-2 | \
  docker login --username AWS --password-stdin \
  486918185988.dkr.ecr.ap-southeast-2.amazonaws.com

# 3. Tag image
echo "üè∑Ô∏è  Tagging image..."
docker tag flower_shop_app:latest \
  486918185988.dkr.ecr.ap-southeast-2.amazonaws.com/flower_shop_app:latest

# 4. Push to ECR
echo "‚¨ÜÔ∏è  Pushing to ECR..."
docker push 486918185988.dkr.ecr.ap-southeast-2.amazonaws.com/flower_shop_app:latest

# 5. Update ECS service
echo "üîÑ Updating ECS service..."
aws ecs update-service \
  --cluster flower-shop-cluster \
  --service flower-shop-service \
  --force-new-deployment \
  --region ap-southeast-2 \
  --query 'service.serviceName' \
  --output text

# 6. Wait for deployment
echo "‚è≥ Waiting for deployment (2 minutes)..."
sleep 120

# 7. Check status
echo "‚úÖ Checking deployment status..."
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2 \
  --query 'services[0].{Status:status,Running:runningCount}' \
  --output table

# 8. Update DuckDNS
echo "ü¶Ü Updating DuckDNS..."
./update-duckdns.sh

echo "üéâ Deployment completed!"
echo "üåê Visit: http://starshop-hcmute.duckdns.org"
```

S·ª≠ d·ª•ng:
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## üóÑÔ∏è Qu·∫£n L√Ω Database

### **K·∫øt n·ªëi v√†o Database:**

```bash
# S·ª≠ d·ª•ng psql
psql -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
     -U flower_admin \
     -d flower_shop_system \
     -p 5432

# Nh·∫≠p password: flower_password_2024
```

### **Ch·∫°y Migration/Schema Changes:**

```bash
# 1. K·∫øt n·ªëi v√†o database
psql -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
     -U flower_admin \
     -d flower_shop_system

# 2. Ch·∫°y SQL file
\i /path/to/migration.sql

# Ho·∫∑c
psql -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
     -U flower_admin \
     -d flower_shop_system \
     -f migration.sql
```

### **Backup Database:**

```bash
# Backup to√†n b·ªô database
pg_dump -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
        -U flower_admin \
        -d flower_shop_system \
        -F c \
        -f backup_$(date +%Y%m%d_%H%M%S).dump

# Backup ch·ªâ schema
pg_dump -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
        -U flower_admin \
        -d flower_shop_system \
        --schema-only \
        -f schema_backup.sql

# Backup ch·ªâ data
pg_dump -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
        -U flower_admin \
        -d flower_shop_system \
        --data-only \
        -f data_backup.sql
```

### **Restore Database:**

```bash
# Restore t·ª´ dump file
pg_restore -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
           -U flower_admin \
           -d flower_shop_system \
           -c \
           backup_20241022.dump

# Restore t·ª´ SQL file
psql -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
     -U flower_admin \
     -d flower_shop_system \
     -f backup.sql
```

---

## ‚öôÔ∏è Qu·∫£n L√Ω Bi·∫øn M√¥i Tr∆∞·ªùng

### **Danh s√°ch bi·∫øn m√¥i tr∆∞·ªùng hi·ªán t·∫°i:**

File: `task-definition.json`

```json
{
  "SPRING_PROFILES_ACTIVE": "prod",
  "SPRING_DATASOURCE_URL": "jdbc:postgresql://flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com:5432/flower_shop_system",
  "SPRING_DATASOURCE_USERNAME": "flower_admin",
  "SPRING_DATASOURCE_PASSWORD": "flower_password_2024",
  "SPRING_MAIL_HOST": "smtp.gmail.com",
  "SPRING_MAIL_PORT": "587",
  "SPRING_MAIL_USERNAME": "starshop.a.6868@gmail.com",
  "SPRING_MAIL_PASSWORD": "mqai nigf sweg imek",
  "SPRING_MAIL_PROPERTIES_MAIL_SMTP_AUTH": "true",
  "SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE": "true",
  "SPRING_MAIL_FROM": "starshop.a.6868@gmail.com",
  "JWT_SECRET": "starshop_jwt_secret_key_2024_very_secure_key_for_production_use",
  "JWT_EXPIRATION": "86400000",
  "APP_BASE_URL": "http://16.176.203.154:8080",
  "APP_UPLOAD_DIR": "uploads",
  "MOMO_BASE_URL": "https://test-payment.momo.vn",
  "MOMO_PARTNER_CODE": "MOMO",
  "MOMO_ACCESS_KEY": "F8BBA842ECF85",
  "MOMO_SECRET_KEY": "K951B6PE1waDMi640xX08PD3vg6EkVlz",
  "MOMO_RETURN_URL": "http://16.176.203.154:8080/payment/momo/return",
  "MOMO_NOTIFY_URL": "http://16.176.203.154:8080/payment/momo/notify",
  "GHN_BASE_URL": "https://online-gateway.ghn.vn/shiip/public-api",
  "GHN_TOKEN": "cd8acb1f-9e9c-11f0-b0e8-f2157cd9069b",
  "GHN_SHOP_ID": "6040148",
  "GEMINI_API_KEY": "AIzaSyB4tCAr_Y5VqAGzpVF01_lc6fEOCbyd9Oo",
  "SPRING_JPA_HIBERNATE_DDL_AUTO": "none",
  "SPRING_JPA_SHOW_SQL": "false",
  "SPRING_JPA_OPEN_IN_VIEW": "false",
  "SWAGGER_SERVER_PROD_URL": "http://16.176.203.154:8080",
  "SOCKJS_CLIENT_LIBRARY_URL": "https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js",
  "FACEBOOK_AVATAR_URL_TEMPLATE": "https://graph.facebook.com/{id}/picture?type=large",
  "CORS_ALLOWED_ORIGINS": "http://16.176.203.154:8080"
}
```

### **C·∫≠p nh·∫≠t bi·∫øn m√¥i tr∆∞·ªùng:**

#### **C√°ch 1: S·ª≠a file task-definition.json**

```bash
# 1. S·ª≠a file task-definition.json
nano task-definition.json

# 2. ƒêƒÉng k√Ω Task Definition m·ªõi
aws ecs register-task-definition \
  --cli-input-json file://task-definition.json \
  --region ap-southeast-2

# 3. C·∫≠p nh·∫≠t service v·ªõi revision m·ªõi (v√≠ d·ª• revision 8)
aws ecs update-service \
  --cluster flower-shop-cluster \
  --service flower-shop-service \
  --task-definition flower-shop-task:8 \
  --force-new-deployment \
  --region ap-southeast-2
```

#### **C√°ch 2: S·ª≠ d·ª•ng AWS Console**

1. V√†o **ECS** ‚Üí **Task Definitions** ‚Üí **flower-shop-task**
2. Ch·ªçn revision m·ªõi nh·∫•t ‚Üí **Create new revision**
3. Scroll xu·ªëng **Environment variables**
4. Th√™m/S·ª≠a/X√≥a bi·∫øn m√¥i tr∆∞·ªùng
5. Click **Create**
6. V√†o **Services** ‚Üí **flower-shop-service** ‚Üí **Update**
7. Ch·ªçn **Revision** m·ªõi v·ª´a t·∫°o
8. Click **Update**

### **Th√™m bi·∫øn m√¥i tr∆∞·ªùng m·ªõi:**

N·∫øu code c·∫ßn th√™m bi·∫øn m√¥i tr∆∞·ªùng m·ªõi:

1. Th√™m v√†o `task-definition.json`:
```json
{
  "name": "NEW_VARIABLE_NAME",
  "value": "new_value"
}
```

2. ƒêƒÉng k√Ω v√† deploy:
```bash
aws ecs register-task-definition --cli-input-json file://task-definition.json --region ap-southeast-2
aws ecs update-service --cluster flower-shop-cluster --service flower-shop-service --task-definition flower-shop-task:NEW_REVISION --force-new-deployment --region ap-southeast-2
```

---

## üìä Monitoring v√† Logs

### **Xem Logs:**

```bash
# Xem logs realtime
aws logs tail /ecs/flower-shop-task --follow --region ap-southeast-2

# Xem logs 10 ph√∫t g·∫ßn nh·∫•t
aws logs tail /ecs/flower-shop-task --since 10m --region ap-southeast-2

# Xem logs 1 gi·ªù g·∫ßn nh·∫•t
aws logs tail /ecs/flower-shop-task --since 1h --region ap-southeast-2

# L·ªçc logs c√≥ ch·ª©a "ERROR"
aws logs tail /ecs/flower-shop-task --since 30m --region ap-southeast-2 | grep ERROR

# L·ªçc logs c√≥ ch·ª©a "Exception"
aws logs tail /ecs/flower-shop-task --since 1h --region ap-southeast-2 | grep -i exception
```

### **Xem tr·∫°ng th√°i Service:**

```bash
# Tr·∫°ng th√°i t·ªïng quan
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2 \
  --query 'services[0].{Status:status,DesiredCount:desiredCount,RunningCount:runningCount,PendingCount:pendingCount}' \
  --output table

# Xem events g·∫ßn nh·∫•t
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2 \
  --query 'services[0].events[0:5]' \
  --output table

# Xem th√¥ng tin tasks
aws ecs list-tasks \
  --cluster flower-shop-cluster \
  --service-name flower-shop-service \
  --region ap-southeast-2

# Xem chi ti·∫øt task
aws ecs describe-tasks \
  --cluster flower-shop-cluster \
  --tasks TASK_ARN \
  --region ap-southeast-2
```

### **L·∫•y Public IP hi·ªán t·∫°i:**

```bash
# S·ª≠ d·ª•ng script
./update-duckdns.sh

# Ho·∫∑c th·ªß c√¥ng
TASK_ARN=$(aws ecs list-tasks --cluster flower-shop-cluster --service-name flower-shop-service --region ap-southeast-2 --query 'taskArns[0]' --output text | awk -F'/' '{print $NF}')
ENI_ID=$(aws ecs describe-tasks --cluster flower-shop-cluster --tasks $TASK_ARN --region ap-southeast-2 --query 'tasks[0].attachments[0].details[?name==`networkInterfaceId`].value' --output text)
aws ec2 describe-network-interfaces --network-interface-ids $ENI_ID --region ap-southeast-2 --query 'NetworkInterfaces[0].Association.PublicIp' --output text
```

---

## üîß Troubleshooting

### **Container kh√¥ng kh·ªüi ƒë·ªông:**

```bash
# 1. Xem logs ƒë·ªÉ t√¨m l·ªói
aws logs tail /ecs/flower-shop-task --since 10m --region ap-southeast-2 | tail -100

# 2. Ki·ªÉm tra events
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2 \
  --query 'services[0].events[0:10]'

# 3. Ki·ªÉm tra task definition
aws ecs describe-task-definition \
  --task-definition flower-shop-task \
  --region ap-southeast-2

# 4. Ki·ªÉm tra security groups
aws ec2 describe-security-groups \
  --group-ids sg-09b68a2f85c567cf6 \
  --region ap-southeast-2
```

### **Kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c database:**

```bash
# 1. Ki·ªÉm tra security group c·ªßa RDS
aws ec2 describe-security-groups \
  --group-ids sg-028b57fab2c0669a0 \
  --region ap-southeast-2

# 2. Ki·ªÉm tra RDS c√≥ ƒëang ch·∫°y kh√¥ng
aws rds describe-db-instances \
  --db-instance-identifier flower-shop-db-instance \
  --region ap-southeast-2 \
  --query 'DBInstances[0].{Status:DBInstanceStatus,Endpoint:Endpoint.Address}'

# 3. Test k·∫øt n·ªëi t·ª´ local
psql -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
     -U flower_admin \
     -d flower_shop_system
```

### **·ª®ng d·ª•ng ch·∫°y ch·∫≠m:**

```bash
# 1. Ki·ªÉm tra CPU v√† Memory usage
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2

# 2. Xem logs ƒë·ªÉ t√¨m bottleneck
aws logs tail /ecs/flower-shop-task --since 30m --region ap-southeast-2 | grep -i "slow\|timeout"

# 3. TƒÉng CPU/Memory trong task definition
# S·ª≠a file task-definition.json:
# "cpu": "2048",  # t·ª´ 1024 l√™n 2048
# "memory": "4096"  # t·ª´ 2048 l√™n 4096
```

### **Domain kh√¥ng truy c·∫≠p ƒë∆∞·ª£c:**

```bash
# 1. Ki·ªÉm tra DNS
nslookup starshop-hcmute.duckdns.org

# 2. Ki·ªÉm tra IP c√≥ ƒë√∫ng kh√¥ng
dig starshop-hcmute.duckdns.org

# 3. C·∫≠p nh·∫≠t DuckDNS
./update-duckdns.sh

# 4. Test HTTP
curl -I http://starshop-hcmute.duckdns.org

# 5. Ki·ªÉm tra security group c√≥ m·ªü port 80 kh√¥ng
aws ec2 describe-security-groups \
  --group-ids sg-09b68a2f85c567cf6 \
  --region ap-southeast-2 \
  --query 'SecurityGroups[0].IpPermissions[?FromPort==`80`]'
```

### **L·ªói "Could not resolve placeholder":**

Thi·∫øu bi·∫øn m√¥i tr∆∞·ªùng. Th√™m v√†o `task-definition.json` v√† deploy l·∫°i.

```bash
# 1. Xem l·ªói c·ª• th·ªÉ
aws logs tail /ecs/flower-shop-task --since 5m --region ap-southeast-2 | grep "Could not resolve placeholder"

# 2. Th√™m bi·∫øn v√†o task-definition.json
# 3. Deploy l·∫°i
```

---

## üíæ Backup v√† Restore

### **Backup Database ƒë·ªãnh k·ª≥:**

T·∫°o script `backup-db.sh`:

```bash
#!/bin/bash

BACKUP_DIR="./backups"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/flower_shop_backup_$TIMESTAMP.dump"

mkdir -p $BACKUP_DIR

echo "üóÑÔ∏è  Backing up database..."

pg_dump -h flower-shop-db-instance.c5gc6e8m62lz.ap-southeast-2.rds.amazonaws.com \
        -U flower_admin \
        -d flower_shop_system \
        -F c \
        -f $BACKUP_FILE

if [ $? -eq 0 ]; then
    echo "‚úÖ Backup successful: $BACKUP_FILE"
    
    # X√≥a backup c≈© h∆°n 7 ng√†y
    find $BACKUP_DIR -name "*.dump" -mtime +7 -delete
    echo "üßπ Cleaned up old backups"
else
    echo "‚ùå Backup failed"
    exit 1
fi
```

Ch·∫°y ƒë·ªãnh k·ª≥ v·ªõi cron:
```bash
# M·ªü crontab
crontab -e

# Th√™m d√≤ng n√†y ƒë·ªÉ backup m·ªói ng√†y l√∫c 2h s√°ng
0 2 * * * /path/to/backup-db.sh
```

### **Backup Docker Image:**

```bash
# Save image to tar file
docker save flower_shop_app:latest -o flower_shop_app_backup.tar

# Load image from tar file
docker load -i flower_shop_app_backup.tar
```

### **Backup Task Definition:**

```bash
# Export task definition
aws ecs describe-task-definition \
  --task-definition flower-shop-task \
  --region ap-southeast-2 \
  > task-definition-backup.json
```

---

## üìù Checklist Tr∆∞·ªõc Khi Deploy

- [ ] Code ƒë√£ ƒë∆∞·ª£c test k·ªπ tr√™n local
- [ ] Database migration (n·∫øu c√≥) ƒë√£ ƒë∆∞·ª£c review
- [ ] Bi·∫øn m√¥i tr∆∞·ªùng m·ªõi (n·∫øu c√≥) ƒë√£ ƒë∆∞·ª£c th√™m v√†o task-definition.json
- [ ] ƒê√£ backup database
- [ ] ƒê√£ th√¥ng b√°o cho team v·ªÅ downtime (n·∫øu c√≥)
- [ ] ƒê√£ chu·∫©n b·ªã rollback plan

---

## üîÑ Rollback

N·∫øu deployment c√≥ v·∫•n ƒë·ªÅ, rollback v·ªÅ version c≈©:

```bash
# 1. Xem danh s√°ch task definition revisions
aws ecs list-task-definitions \
  --family-prefix flower-shop-task \
  --region ap-southeast-2

# 2. Rollback v·ªÅ revision tr∆∞·ªõc (v√≠ d·ª• revision 6)
aws ecs update-service \
  --cluster flower-shop-cluster \
  --service flower-shop-service \
  --task-definition flower-shop-task:6 \
  --force-new-deployment \
  --region ap-southeast-2

# 3. Ki·ªÉm tra
aws ecs describe-services \
  --cluster flower-shop-cluster \
  --services flower-shop-service \
  --region ap-southeast-2 \
  --query 'services[0].taskDefinition'
```

---

## üìû Li√™n H·ªá v√† H·ªó Tr·ª£

- **AWS Account ID**: 486918185988
- **Region**: ap-southeast-2
- **User**: vien

---

## üìö T√†i Li·ªáu Tham Kh·∫£o

- [AWS ECS Documentation](https://docs.aws.amazon.com/ecs/)
- [Docker Documentation](https://docs.docker.com/)
- [DuckDNS Documentation](https://www.duckdns.org/spec.jsp)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)

---

**C·∫≠p nh·∫≠t l·∫ßn cu·ªëi**: 22/10/2025  
**Version**: 1.0
